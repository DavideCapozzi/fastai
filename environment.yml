# ============================================================================
# FastAI Complete Environment for fast.ai Course 2025
# ============================================================================
# Optimized for WSL2/Ubuntu with Micromamba
# Resolves all PyTorch Anaconda channel deprecation issues (Oct 2024)
# Tested with Python 3.11, PyTorch 2.5+, FastAI 2.7.14+
#
# WHY THIS CONFIGURATION:
# - PyTorch conda channel deprecated (Oct 2024)
# - pytorch-gpu from conda-forge sometimes installs CPU version on WSL2
# - Using pip for PyTorch is now recommended and most reliable
#
# INSTALLATION STEPS:
#   1. Create environment:
#      micromamba env create -f fastai_env.yml -y
#   
#   2. Activate environment:
#      micromamba activate fastai-course
#   
#   3. Install PyTorch with CUDA support:
#      pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu124
#   
#   4. Verify installation:
#      python -c "import torch; print(f'PyTorch: {torch.__version__}'); print(f'CUDA available: {torch.cuda.is_available()}')"
#      python -c "import fastai; print(f'FastAI: {fastai.__version__}')"
#
# TROUBLESHOOTING:
#   - If CUDA shows False, check NVIDIA driver: nvidia-smi
#   - WSL2 requires Windows NVIDIA driver (not WSL CUDA toolkit)
#   - Driver version should be 510.00 or higher
# ============================================================================

name: fastai-course

channels:
  - conda-forge
  - defaults

dependencies:
  # ============= Core Python Environment =============
  - python=3.11
  
  # ============= Jupyter Development Environment =============
  - jupyter>=1.0
  - jupyterlab>=4.0,<5.0
  - ipykernel>=6.25
  - ipywidgets>=8.0,<9.0
  - nodejs>=18,<21
  
  # ============= Core Data Science Stack =============
  # CRITICAL: numpy<2.0 for scipy/fastai compatibility
  - numpy>=1.26.4,<2.0
  - scipy>=1.11.0,<1.14
  - pandas>=2.0.0,<2.3
  - scikit-learn>=1.3.0,<1.6
  - matplotlib>=3.7.0,<3.10
  - seaborn>=0.12.0
  - pillow>=10.0.0
  - requests>=2.31.0
  
  # ============= Compatibility Layers =============
  - array-api-compat>=1.4  # Fixes scipy import warnings
  
  # ============= FastAI Core Dependencies =============
  - fastcore>=1.5.29
  - fastdownload>=0.0.7
  - pyyaml>=6.0
  - click>=8.0
  - lxml>=4.9.0
  - graphviz
  - packaging>=23.0
  
  # ============= Package Manager =============
  - pip>=23.0
  
  # ============= Python Packages (via pip) =============
  - pip:
      # --- FastAI Ecosystem ---
      - fastai>=2.7.14
      - nbdev>=2.3.12
      - fastprogress>=1.0.3
      
      # --- Natural Language Processing ---
      - spacy>=3.7.0
      - sentencepiece>=0.1.99
      
      # --- Image Search APIs ---
      - azure-cognitiveservices-search-imagesearch>=2.0.0
      - duckduckgo-search>=5.0.0
      
      # --- Jupyter Extensions ---
      - jupyter-contrib-nbextensions>=0.7.0
      
      # --- Computer Vision & Augmentation ---
      - albumentations>=1.3.1
      - opencv-python>=4.8.0
      - timm>=0.9.12              # PyTorch Image Models
      
      # --- Additional ML Utilities ---
      - category-encoders>=2.6.0   # Categorical encoding
      - kaggle>=1.6.0              # Kaggle API for datasets
      - gradio>=4.0.0              # Web UI for models
      
      # NOTE: PyTorch must be installed SEPARATELY after environment creation
      # Run: pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu124
